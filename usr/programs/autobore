-- step one, put chest in front of the turtle
-- this is where the turtle will put things not
--   from slot 1 and the ignore slots
local slotString
local depth
local holes

local args = {...}

if #args ~= 3
then
  print("Usage: <ignorestring> <depth> <#holes>")
  print("Ex: 258b 20 3 (ignore slots 2,5,8,and 11, depth 20, 3 holes)")
  return
end

-- load arguments
slotString = args[1]
depth = tonumber(args[2])
holes = tonumber(args[3])
local ignoreSlot = {}


for i = 1,#slotString
do
  ignoreSlot[ tonumber( slotString:sub(i,i) , 16 ) ] = true
end

-- record chest location
local chestPos = location.getPos()
local chestHead = location.getHeading()

-- turn back on chest, and go
turtle.turnLeft()
turtle.turnLeft()

for h = 1,holes
do
  -- run bore on new spot
  move.digTo(chestHead*-3*h + chestPos)
  shell.run(shell.resolve("bore"), slotString.." "..depth)
  
  -- drop off stuff in chest
  move.goTo(chestPos)
  move.turnTo(chestHead)
  
  for i = 2,16
  do
    -- make sure it is not on ignoreslots
    if not ignoreSlot[i]
    then
      print( i .. " is not ignored")
      -- confirm there is a block in front
      if not turtle.detect()
      then
        return
      end
      
      -- transfer items
      turtle.select(i)
      turtle.drop()
    end
  end
end
